# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

Project overview
- Static site built with Jekyll using the al-folio theme. Primary configuration lives in _config.yml. Content is authored in Markdown/Liquid and rendered via layouts and includes.
- CI builds to the gh-pages branch on push to main/master. Optional workflows check formatting, links, and accessibility.

Common commands
- Local dev (Docker, recommended)
```bash path=null start=null
docker compose pull
docker compose up
# Open http://localhost:8080 (livereload on 35729)
```
- Local dev (Ruby toolchain)
```bash path=null start=null
bundle install
bundle exec jekyll serve
# Open http://localhost:4000
```
- Build site
```bash path=null start=null
bundle exec jekyll build
# or
bin/cibuild
```
- Production build with CSS purge
```bash path=null start=null
JEKYLL_ENV=production bundle exec jekyll build
npx purgecss -c purgecss.config.js
```
- Format and check code (Liquid + markdown + HTML)
```bash path=null start=null
# install once (if needed)
npm install
# check all files
npx prettier . --check
# format in-place
npx prettier . --write
# check a single file
npx prettier _includes/head.liquid --check
```
- Manual deploy to GitHub Pages (alternative to CI deploy)
```bash path=null start=null
bash bin/deploy
# flags: -s/--src <branch>  -d/--deploy <branch>  --no-push  --verbose
```

CI workflows (GitHub Actions)
- Deploy site: builds with JEKYLL_ENV=production, purges CSS, and deploys the _site folder to gh-pages on push to main/master (.github/workflows/deploy.yml).
- Prettier formatter: validates code style; failed runs upload a diff artifact you can review (.github/workflows/prettier.yml).
- Broken links: runs lychee against HTML/MD content on PRs and pushes (.github/workflows/broken-links.yml).
- Axe accessibility: manual trigger via workflow_dispatch; spins up the built site and audits with axe (.github/workflows/axe.yml).

High-level architecture
- Configuration: _config.yml controls site metadata (title, URLs, social), plugins, SASS, third_party_libraries (CDN versions, integrity, and a download toggle), analytics, Jekyll Scholar, and Imagemagick settings.
- Content model
  - Collections: _news and _projects are configured as Jekyll collections with custom permalinks; blog posts live under _posts.
  - Pages: Markdown under _pages defines top-level routes (about, cv, projects, publications, etc.).
  - Data-driven sections: _data/*.yml drives coauthors, CV, repositories, venues; bibliographic data under _bibliography/papers.bib powers publications via jekyll-scholar.
- Rendering pipeline
  - Layouts: _layouts/*.liquid (e.g., default.liquid, post.liquid, distill.liquid) define page skeletons.
  - Partials: _includes/** contains reusable UI components and script/style includes (analytics, charts, mathjax, search, etc.).
  - Assets: assets/css/main.scss compiled (sass: style: compressed); assets/js contains theme JS. Responsive images generated by jekyll-imagemagick per settings in _config.yml.
  - Custom plugins: _plugins/*.rb adds bespoke Liquid tags/filters (cache busting, downloads, citations, etc.).
- Output: Jekyll writes to _site/ (checked into this repo for convenience); production deploy publishes that folder to gh-pages.

Notes for development
- Prefer Docker for a consistent environment; otherwise ensure Ruby, Bundler, and Imagemagick are installed before serving/building.
- There is no unit test suite; the primary local checks are Prettier and optional CSS purge. Link and accessibility checks run in CI.
